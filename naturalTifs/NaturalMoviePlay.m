origMovie = makemovie('naturalTifs', 'merry', 4, 100);%mkFilteredMovie('','merry',2)filter='none'; % 'none'/'low'/'high'computerType = computer;% pre-load this for faster presentation%movie.name.folder='movie01';% if strcmp(computerType,'MAC2')%	 volSpec = 'Macintosh_HD:Natural_Image_Movies';% elseif strcmp(computerType,'PCWIN')%	 volSpec = 'G:\Movies\';% end% NaturalImagePathSpec = fullfile(volSpec,movie.name.folder,''); % cd(NaturalImagePathSpec);% load('movie01_0000_0016'); % temp hardwired code...% Parameterif strcmp(computerType,'MAC2'); screenNumber=1;elseif strcmp(computerType,'PCWIN'); screenNuscreenNumbermber=0;elseif strcmp(computerType, 'GLNXA64'); screenNumber=0;endif strcmp(filter,'none');     nRows=size(origMovie,2); nCols=size(origMovie,1); nFrames=size(origMovie,3);  elseif strcmp(filter,'low');  nRows=size(lpMovie,2);   nCols=size(lpMovie,1);   nFrames=size(lpMovie,3);  elseif strcmp(filter,'high'); nRows=size(hpMovie,2);   nCols=size(hpMovie,1);   nFrames=size(hpMovie,3);endpriorityLevel=MaxPriority(screenNumber,'GetSecs','WaitBlanking');%open screenHideCursor;[window,windowRect]=Screen(screenNumber, 'OpenWindow',0,[],8);rect=SetRect(0,0,nRows,nCols);rect2=CenterRect(rect,windowRect);temp=0;% generate the frames of movie%This loops by itself is able to enter the black screenfor i=1:nFrames    for n=1:1:(round(FrameRate(screenNumber)/NaturalMovie.frames.fps.rec))            temp=temp+1;            w(temp)=Screen(window,'OpenOffscreenWindow',0,rect,8);           if strcmp(filter,'none'); Screen(w(temp),'PutImage',origMovie(:,:,i),rect);		elseif strcmp(filter,'low');  Screen(w(temp),'PutImage',lpMovie(:,:,i),rect);		elseif strcmp(filter,'high'); Screen(w(temp),'PutImage',hpMovie(:,:,i),rect);            end	    endend% Show the movie using Rush to minimize interruptions.missed=zeros(nFrames,1);GetSecs; % Preload all functions.loop={    'Screen(window,''WaitBlanking'');'    'startTime=GetSecs;'    'for i=1:(size(w,2));'        'Screen(''CopyWindow'',w(i),window,rect,rect2);'        'missed(i)=Screen(window,''WaitBlanking'');'    'end;'    'finishTime=GetSecs;'};%Screen('Screens'); GetSecs;Rush(loop,priorityLevel);% Close the on- and off-screen windowsScreen('CloseAll');ShowCursor;% Print resultsfprintf('NaturalMovieDemo\n');s=sprintf('Movie is %gx%g %.0f Hz.',nRows,nCols,FrameRate(screenNumber));s=sprintf('%s Copied %.0f images/sec.',s,2*nFrames/(finishTime-startTime));s=sprintf('%s Missed %g frames.',s,sum(sum([missed])));fprintf('%s\n',WrapString(s));RestoreScreen(screenNumber);