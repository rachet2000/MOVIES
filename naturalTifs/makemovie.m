function [origMovie]=makemovie(folder,movietype,duration,startframe);% loadmovie% following is code for reading in and converting movies from catcam files (although can be generic files as well). % % example: [origMovie]=makemovie('movie01','Catt',3,0);%% INPUT:% folder: Folder where *.tif files are contained (string).% movietype: either 'Catt' or 'Fire' (string).% duration: movie duration in seconds (uint8).% startframe: frame dftfiltin which movie starts (uint8).%% OUTPUT:% origMovie: movie of *.tifs for n duration at 25fps.%% Requires: namepad.m - see bottom for code%namepad%% Aaron Johnson, Feb, 2006.folder = 'naturalTifs';movietype = 'merry';startframe = 0;duration = 4;% varoldernameiables set by user in function callNaturalMovie.name.folder=folder;NaturalMovie.name.type=movietype;NaturalMovie.frames.start=startframe;NaturalMovie.duration=duration; % in seconrgb2gray(double(imread('merry1.TIF'))./255)dscomputerType = computer;			% $$$ if strcmp(computerType,'MAC2')	 volSpec = 'Macintosh_HD:Natural_Image_Movies'; elseif strcmp(computerType,'PCWIN')	 volSpec = 'G:\Movies\'; elseif strcmp(computerType, 'GLNXA64')     volSpec = '/home/david/MOVIES/'; end NaturalImagePathSpec = fullfile(volSpec,NaturalMovie.name.folder,''); % $$ fullfile() is OS-savvy filespec-builder  cd(NaturalImagePathSpec);NaturalMovie.frames.number = size(dir('*.tif'),1); % number of frames avaliable in working directoryNaturalMovie.frames.fps.rec=31; % frame rate%Subscripted assignment dimension mismatch. (fps) - european format% generates either seqential or randomized movies....NaturalMovie.frames.seq=1:1:(NaturalMovie.duration*NaturalMovie.frames.fps.rec); % sequential movie framesNaturalMovie.frames.seq=NaturalMovie.frames.start+NaturalMovie.frames.seq; % add on frames - to be used in implementing multiple samples from movie filefoldername = 'naturalTifs';filename = 'naturalTifs_0.mat';lambda = 2;for n=1:1:(NaturalMovie.duration*NaturalMovie.frames.fps.rec)               % convert filename into 4 digit format needed for CatCam        frameName=namepad(NaturalMovie.frames.seq(n),0);        % load image into memory        filename = strcat(NaturalMovie.name.type,frameName,'.tif');        im=rgb2gray(double(imread(filename))./255);                im = uint8(im.*255);        % quick and dirty repeat-frame code. Only works for multiples of original frame rate e.g. Orignal 25fps goes up to 50,75,100 fps.        origMovie(:,:,n)=im(1:480, 1:480);end% Name of File = FOLDER_MOVIETYPE_FINALFRAMENONaturalMovie.frames.start=namepad(NaturalMovie.frames.start,0);moviename=strcat(NaturalMovie.name.folder,'_',NaturalMovie.frames.start);save(moviename,'origMovie','NaturalMovie');